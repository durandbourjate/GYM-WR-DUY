<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VWL √úbungspool: BIP | EWR GYM2</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,600;0,700;1,400&family=DM+Mono:wght@400;500&display=swap');

  :root {
    --c-bg: #f0f2f5;
    --c-surface: #ffffff;
    --c-primary: #1a365d;
    --c-primary-light: #2a5298;
    --c-accent: #e8a838;
    --c-accent-light: #fef3c7;
    --c-success: #16a34a;
    --c-success-bg: #f0fdf4;
    --c-error: #dc2626;
    --c-error-bg: #fef2f2;
    --c-info: #2563eb;
    --c-info-bg: #eff6ff;
    --c-text: #1e293b;
    --c-text-soft: #64748b;
    --c-border: #e2e8f0;
    --c-hover: #f8fafc;
    --radius: 10px;
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.06);
    --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'DM Sans', system-ui, sans-serif;
    background: var(--c-bg);
    color: var(--c-text);
    line-height: 1.6;
    min-height: 100vh;
  }

  /* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
  .app-header {
    background: linear-gradient(135deg, var(--c-primary) 0%, var(--c-primary-light) 100%);
    color: white;
    padding: 20px 24px;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 2px 12px rgba(0,0,0,0.15);
  }
  .app-header h1 { font-size: 1.25rem; font-weight: 700; letter-spacing: -0.02em; }
  .app-header .meta { font-size: 0.8rem; opacity: 0.75; margin-top: 2px; }

  .container { max-width: 720px; margin: 0 auto; padding: 20px 16px 100px; }

  /* ‚îÄ‚îÄ Start Screen ‚îÄ‚îÄ */
  .screen { display: none; }
  .screen.active { display: block; }

  .start-card {
    background: var(--c-surface);
    border-radius: var(--radius);
    padding: 28px;
    margin-bottom: 16px;
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--c-border);
  }
  .start-card h2 {
    font-size: 1.05rem;
    font-weight: 700;
    margin-bottom: 14px;
    color: var(--c-primary);
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .start-card h2 .icon { font-size: 1.2rem; }

  /* Mode selector */
  .mode-cards { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 8px; }
  .mode-card {
    padding: 18px 16px;
    border: 2px solid var(--c-border);
    border-radius: var(--radius);
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
  }
  .mode-card:hover { border-color: var(--c-primary-light); background: var(--c-hover); }
  .mode-card.selected { border-color: var(--c-primary); background: #eef2ff; }
  .mode-card .mode-icon { font-size: 1.8rem; margin-bottom: 6px; }
  .mode-card .mode-title { font-weight: 700; font-size: 0.92rem; margin-bottom: 4px; }
  .mode-card .mode-desc { font-size: 0.78rem; color: var(--c-text-soft); line-height: 1.4; }

  /* Filter chips */
  .filter-group { margin-bottom: 16px; }
  .filter-label {
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--c-text-soft);
    margin-bottom: 8px;
  }
  .chips { display: flex; flex-wrap: wrap; gap: 6px; }
  .chip {
    padding: 6px 14px;
    border: 1.5px solid var(--c-border);
    border-radius: 20px;
    font-size: 0.82rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.15s;
    user-select: none;
    white-space: nowrap;
  }
  .chip:hover { border-color: var(--c-primary-light); }
  .chip.selected { background: var(--c-primary); color: white; border-color: var(--c-primary); }
  .chip .chip-count {
    display: inline-block;
    background: rgba(0,0,0,0.08);
    border-radius: 10px;
    padding: 0 6px;
    font-size: 0.72rem;
    margin-left: 4px;
  }
  .chip.selected .chip-count { background: rgba(255,255,255,0.25); }

  /* Start button */
  .start-btn {
    width: 100%;
    padding: 14px;
    background: var(--c-primary);
    color: white;
    border: none;
    border-radius: var(--radius);
    font-family: inherit;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    transition: background 0.2s;
    letter-spacing: -0.01em;
  }
  .start-btn:hover { background: var(--c-primary-light); }
  .start-btn:disabled { opacity: 0.4; cursor: not-allowed; }
  .question-count-info {
    text-align: center;
    font-size: 0.85rem;
    color: var(--c-text-soft);
    margin-bottom: 14px;
    min-height: 1.4em;
  }

  /* ‚îÄ‚îÄ Quiz Screen ‚îÄ‚îÄ */
  .quiz-topbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
    font-size: 0.82rem;
    color: var(--c-text-soft);
  }
  .quiz-progress-track {
    height: 5px;
    background: var(--c-border);
    border-radius: 3px;
    margin-bottom: 20px;
    overflow: hidden;
  }
  .quiz-progress-fill {
    height: 100%;
    background: var(--c-accent);
    border-radius: 3px;
    transition: width 0.4s ease;
  }

  .q-card {
    background: var(--c-surface);
    border-radius: var(--radius);
    padding: 28px;
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--c-border);
    margin-bottom: 16px;
    animation: fadeIn 0.3s ease;
  }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

  .q-badges { display: flex; gap: 6px; margin-bottom: 12px; flex-wrap: wrap; }
  .q-badge {
    font-size: 0.68rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    padding: 3px 10px;
    border-radius: 4px;
  }
  .badge-topic { background: #dbeafe; color: #1e40af; }
  .badge-diff-1 { background: #dcfce7; color: #166534; }
  .badge-diff-2 { background: #fef9c3; color: #854d0e; }
  .badge-diff-3 { background: #fee2e2; color: #991b1b; }
  .badge-type { background: #f3e8ff; color: #7c3aed; }
  .badge-tax { background: #e0e7ff; color: #3730a3; }

  .q-text {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 18px;
    line-height: 1.55;
    color: var(--c-text);
  }

  /* MC / TF Options */
  .q-options { display: flex; flex-direction: column; gap: 8px; }
  .q-opt {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 13px 16px;
    border: 2px solid var(--c-border);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.15s;
    font-size: 0.92rem;
    line-height: 1.5;
  }
  .q-opt:hover { border-color: #94a3b8; background: var(--c-hover); }
  .q-opt.selected { border-color: var(--c-info); background: var(--c-info-bg); }
  .q-opt.correct { border-color: var(--c-success); background: var(--c-success-bg); }
  .q-opt.wrong { border-color: var(--c-error); background: var(--c-error-bg); }
  .q-opt.was-correct { border-color: var(--c-success); background: var(--c-success-bg); }
  .q-opt.locked { cursor: default; pointer-events: none; }
  .q-opt-marker {
    width: 26px; height: 26px; min-width: 26px;
    border: 2px solid #cbd5e1;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 0.75rem; font-weight: 700; color: #94a3b8;
    transition: all 0.15s;
  }
  .q-opt.selected .q-opt-marker { border-color: var(--c-info); color: var(--c-info); }
  .q-opt.correct .q-opt-marker { border-color: var(--c-success); color: white; background: var(--c-success); }
  .q-opt.wrong .q-opt-marker { border-color: var(--c-error); color: white; background: var(--c-error); }
  .q-opt.was-correct .q-opt-marker { border-color: var(--c-success); color: white; background: var(--c-success); }

  /* Fill blanks in quiz */
  .q-fill-input {
    display: inline-block;
    border: none;
    border-bottom: 2px solid var(--c-info);
    background: #f8fafc;
    padding: 3px 6px;
    font-family: inherit;
    font-size: 0.92rem;
    width: 180px;
    text-align: center;
    outline: none;
    transition: all 0.2s;
  }
  .q-fill-input:focus { border-color: var(--c-primary); background: var(--c-info-bg); }
  .q-fill-input.correct { border-color: var(--c-success); background: var(--c-success-bg); color: #166534; }
  .q-fill-input.wrong { border-color: var(--c-error); background: var(--c-error-bg); color: #991b1b; }

  /* Calc inputs */
  .q-calc-input {
    width: 90px;
    padding: 7px 10px;
    border: 2px solid var(--c-border);
    border-radius: 6px;
    font-family: 'DM Mono', monospace;
    font-size: 0.9rem;
    text-align: right;
    outline: none;
  }
  .q-calc-input:focus { border-color: var(--c-info); }
  .q-calc-input.correct { border-color: var(--c-success); background: var(--c-success-bg); }
  .q-calc-input.wrong { border-color: var(--c-error); background: var(--c-error-bg); }

  /* Case text */
  .q-case {
    background: #f8fafc;
    border-left: 4px solid var(--c-info);
    padding: 14px 18px;
    font-size: 0.9rem;
    color: var(--c-text-soft);
    margin-bottom: 16px;
    border-radius: 0 8px 8px 0;
    font-style: italic;
    line-height: 1.6;
  }

  /* Feedback */
  .q-feedback {
    margin-top: 16px;
    padding: 14px 18px;
    border-radius: 8px;
    font-size: 0.88rem;
    line-height: 1.55;
    display: none;
  }
  .q-feedback.visible { display: block; animation: fadeIn 0.25s ease; }
  .q-feedback.success { background: var(--c-success-bg); border: 1px solid #bbf7d0; color: #166534; }
  .q-feedback.error { background: var(--c-error-bg); border: 1px solid #fecaca; color: #991b1b; }
  .q-feedback.info { background: var(--c-info-bg); border: 1px solid #bfdbfe; color: #1e40af; }

  /* Buttons */
  .btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 10px 20px;
    border: none;
    border-radius: 8px;
    font-family: inherit;
    font-size: 0.88rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.15s;
  }
  .btn-check { background: var(--c-primary); color: white; }
  .btn-check:hover { background: var(--c-primary-light); }
  .btn-next { background: var(--c-accent); color: var(--c-primary); }
  .btn-next:hover { background: #d4952e; }
  .btn-ghost { background: var(--c-border); color: var(--c-text-soft); }
  .btn-ghost:hover { background: #cbd5e1; }
  .btn-stop { background: #fee2e2; color: var(--c-error); }
  .btn-stop:hover { background: #fecaca; }
  .btn-row { display: flex; gap: 8px; margin-top: 16px; flex-wrap: wrap; }

  /* ‚îÄ‚îÄ Results Screen ‚îÄ‚îÄ */
  .results-card {
    background: var(--c-surface);
    border-radius: var(--radius);
    padding: 28px;
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--c-border);
    margin-bottom: 16px;
    text-align: center;
  }
  .results-score {
    font-size: 3rem;
    font-weight: 700;
    color: var(--c-primary);
    line-height: 1;
    margin: 12px 0;
    font-family: 'DM Mono', monospace;
  }
  .results-label { font-size: 0.85rem; color: var(--c-text-soft); }
  .results-bar {
    height: 8px;
    background: var(--c-border);
    border-radius: 4px;
    margin: 16px 0;
    overflow: hidden;
  }
  .results-bar-fill {
    height: 100%;
    border-radius: 4px;
    transition: width 0.6s ease;
  }

  .topic-breakdown {
    text-align: left;
    margin-top: 16px;
  }
  .topic-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid var(--c-border);
    font-size: 0.88rem;
  }
  .topic-row:last-child { border-bottom: none; }
  .topic-row .topic-name { font-weight: 500; }
  .topic-row .topic-score { font-family: 'DM Mono', monospace; font-weight: 600; }
  .topic-score.good { color: var(--c-success); }
  .topic-score.ok { color: #d97706; }
  .topic-score.bad { color: var(--c-error); }

  .wrong-list { text-align: left; margin-top: 16px; }
  .wrong-item {
    padding: 14px 16px;
    background: var(--c-error-bg);
    border-radius: 8px;
    margin-bottom: 8px;
    font-size: 0.88rem;
    border: 1px solid #fecaca;
  }
  .wrong-item .wi-q { font-weight: 600; margin-bottom: 6px; color: #991b1b; }
  .wrong-item .wi-a { color: #166534; }

  /* Print styles */
  @media print {
    .app-header { position: static !important; box-shadow: none !important; }
    .btn, .quiz-topbar, .q-badges .badge-type, .q-badges .badge-tax { display: none !important; }
    .q-card { break-inside: avoid; box-shadow: none !important; }
    .q-feedback.visible { display: block !important; }
    .screen.active { display: block !important; }
  }

  @media (max-width: 600px) {
    .container { padding: 14px 10px 80px; }
    .start-card, .q-card, .results-card { padding: 20px 16px; }
    .mode-cards { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<div class="app-header">
  <h1>√úbungspool: Bruttoinlandprodukt (BIP)</h1>
  <div class="meta">EWR GYM2 ¬∑ Gymnasium Hofwil ¬∑ Individuell √ºben</div>
</div>

<div class="container">

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê START SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="screen active" id="startScreen">

    <div class="start-card">
      <h2><span class="icon">üéØ</span> Modus w√§hlen</h2>
      <div class="mode-cards">
        <div class="mode-card selected" data-mode="fokus" onclick="selectMode(this)">
          <div class="mode-icon">üîç</div>
          <div class="mode-title">Fokus</div>
          <div class="mode-desc">√úben Sie gezielt ein Unterthema ‚Äî von einfach nach schwierig.</div>
        </div>
        <div class="mode-card" data-mode="mix" onclick="selectMode(this)">
          <div class="mode-icon">üîÄ</div>
          <div class="mode-title">Mix</div>
          <div class="mode-desc">Zuf√§llige Mischung aller Themen ‚Äî ideal zur Repetition.</div>
        </div>
      </div>
    </div>

    <div class="start-card" id="filterCard">
      <h2><span class="icon">‚öôÔ∏è</span> √úbungen anpassen</h2>

      <div class="filter-group">
        <div class="filter-label">Unterthema</div>
        <div class="chips" id="topicChips"></div>
      </div>

      <div class="filter-group">
        <div class="filter-label">Schwierigkeit</div>
        <div class="chips" id="diffChips">
          <div class="chip" data-diff="1" onclick="toggleChip(this, 'diff')">‚≠ê Einfach</div>
          <div class="chip" data-diff="2" onclick="toggleChip(this, 'diff')">‚≠ê‚≠ê Mittel</div>
          <div class="chip" data-diff="3" onclick="toggleChip(this, 'diff')">‚≠ê‚≠ê‚≠ê Schwer</div>
        </div>
      </div>

      <div class="filter-group">
        <div class="filter-label">Fragetyp</div>
        <div class="chips" id="typeChips">
          <div class="chip selected" data-type="mc" onclick="toggleChip(this, 'type')">Multiple Choice</div>
          <div class="chip selected" data-type="tf" onclick="toggleChip(this, 'type')">Richtig/Falsch</div>
          <div class="chip selected" data-type="fill" onclick="toggleChip(this, 'type')">L√ºckentext</div>
          <div class="chip selected" data-type="calc" onclick="toggleChip(this, 'type')">Berechnung</div>
          <div class="chip selected" data-type="sort" onclick="toggleChip(this, 'type')">Zuordnung</div>
        </div>
      </div>
    </div>

    <div class="start-card">
      <div class="question-count-info" id="questionCountInfo">Laden‚Ä¶</div>
      <button class="start-btn" id="startBtn" onclick="startQuiz()">√úbung starten</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê QUIZ SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="screen" id="quizScreen">
    <div class="quiz-topbar">
      <span id="quizCounter">Aufgabe 1 / 10</span>
      <span id="quizScore">0 Punkte</span>
    </div>
    <div class="quiz-progress-track">
      <div class="quiz-progress-fill" id="quizProgressFill"></div>
    </div>
    <div id="quizContent"></div>
    <div class="btn-row" style="justify-content:center; margin-top:12px;">
      <button class="btn btn-stop" onclick="endQuiz()">√úbung beenden</button>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê RESULTS SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="screen" id="resultsScreen">
    <div class="results-card">
      <h2 style="justify-content:center;">Zusammenfassung</h2>
      <div class="results-score" id="resultsScore">0/0</div>
      <div class="results-label" id="resultsLabel">Punkte erreicht</div>
      <div class="results-bar"><div class="results-bar-fill" id="resultsBarFill"></div></div>
      <div class="topic-breakdown" id="topicBreakdown"></div>
    </div>
    <div class="results-card" id="wrongCard" style="display:none;">
      <h2 style="justify-content:center; color:var(--c-error);">Zum Repetieren</h2>
      <div class="wrong-list" id="wrongList"></div>
    </div>
    <div class="results-card">
      <button class="start-btn" onclick="exportResults()">üìÑ Als PDF speichern</button>
      <div style="height:10px;"></div>
      <button class="start-btn" style="background:var(--c-accent); color:var(--c-primary);" onclick="resetApp()">Neue √úbung starten</button>
    </div>
  </div>

</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// AUFGABENPOOL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const QUESTIONS = [
  // ‚îÄ‚îÄ 1. DEFINITION & GRUNDBEGRIFFE ‚îÄ‚îÄ
  {id:"d01", topic:"definition", type:"mc", diff:1, tax:"K1", 
   q:"Welche der folgenden Definitionen beschreibt das Bruttoinlandprodukt (BIP) am besten?",
   options:[
     {v:"A", t:"Die Summe aller Einkommen der Bev√∂lkerung eines Landes."},
     {v:"B", t:"Der Marktwert aller in einem Land innerhalb eines Jahres hergestellten G√ºter und Dienstleistungen, abz√ºglich der Vorleistungen."},
     {v:"C", t:"Der Wert aller von Schweizer Unternehmen weltweit produzierten G√ºter."},
     {v:"D", t:"Die Summe aller Konsumausgaben in einem Land."}
   ],
   correct:"B",
   explain:"Das BIP misst den Marktwert aller im Inland produzierten G√ºter und Dienstleistungen. Vorleistungen werden abgezogen, um Doppelz√§hlungen zu vermeiden. Antwort A beschreibt eher die Verteilungsseite, C das Bruttonationaleinkommen (BNE) und D nur die Verwendungsseite."
  },
  {id:"d02", topic:"definition", type:"tf", diff:1, tax:"K1",
   q:"Das BIP misst den Wert aller G√ºter, die von Schweizer Staatsb√ºrgern produziert werden, unabh√§ngig davon, wo sie leben.",
   correct: false,
   explain:"Falsch. Das BIP folgt dem Inlandprinzip: Es misst, was innerhalb der Landesgrenzen produziert wird ‚Äî unabh√§ngig von der Nationalit√§t. Was Schweizer im Ausland produzieren, z√§hlt zum Bruttonationaleinkommen (BNE), nicht zum BIP."
  },
  {id:"d03", topic:"definition", type:"mc", diff:2, tax:"K2",
   q:"Weshalb werden Vorleistungen bei der BIP-Berechnung abgezogen?",
   options:[
     {v:"A", t:"Weil Vorleistungen nicht auf dem Markt gehandelt werden."},
     {v:"B", t:"Weil sonst die gleiche Wertsch√∂pfung mehrfach gez√§hlt w√ºrde."},
     {v:"C", t:"Weil Vorleistungen von ausl√§ndischen Unternehmen stammen."},
     {v:"D", t:"Weil Vorleistungen keinen Marktwert haben."}
   ],
   correct:"B",
   explain:"Vorleistungen sind G√ºter, die in den Produktionsprozess eingehen (z.B. Mehl f√ºr den B√§cker). W√ºrde man den Wert des Mehls und des fertigen Brotes z√§hlen, w√§re das Mehl doppelt erfasst. Deshalb wird nur die Wertsch√∂pfung (Brot minus Mehl) gez√§hlt."
  },
  {id:"d04", topic:"definition", type:"fill", diff:1, tax:"K1",
   q:"Vervollst√§ndigen Sie: Das BIP ist definiert als der {0} aller in einem Land innerhalb eines {1} hergestellten G√ºter und Dienstleistungen, abz√ºglich der {2}.",
   blanks:[
     {answer:"Marktwert", alts:["marktwert"]},
     {answer:"Jahres", alts:["jahres", "Jahr", "jahr"]},
     {answer:"Vorleistungen", alts:["vorleistungen"]}
   ],
   explain:"Das BIP = Marktwert aller im Inland in einem Jahr produzierten G√ºter und Dienstleistungen minus Vorleistungen."
  },
  {id:"d05", topic:"definition", type:"mc", diff:2, tax:"K2",
   q:"Ein B√§cker kauft Mehl f√ºr CHF 2.‚Äì und verkauft ein Brot f√ºr CHF 5.‚Äì. Wie hoch ist seine Wertsch√∂pfung (Beitrag zum BIP)?",
   options:[
     {v:"A", t:"CHF 5.‚Äì"},
     {v:"B", t:"CHF 7.‚Äì"},
     {v:"C", t:"CHF 3.‚Äì"},
     {v:"D", t:"CHF 2.‚Äì"}
   ],
   correct:"C",
   explain:"Wertsch√∂pfung = Output (CHF 5.‚Äì) minus Vorleistungen (CHF 2.‚Äì) = CHF 3.‚Äì. Nur diese Differenz ist der Beitrag des B√§ckers zum BIP."
  },
  {id:"d06", topic:"definition", type:"tf", diff:1, tax:"K1",
   q:"Das BIP wird mit Marktpreisen bewertet.",
   correct: true,
   explain:"Richtig. Die G√ºter und Dienstleistungen werden zum Marktpreis bewertet, also zum Preis, zu dem sie auf dem Markt gehandelt werden."
  },
  {id:"d07", topic:"definition", type:"mc", diff:1, tax:"K1",
   q:"Welche der folgenden Aktivit√§ten z√§hlt NICHT zu den Produktionsfaktoren?",
   options:[
     {v:"A", t:"Arbeit"},
     {v:"B", t:"Kapital"},
     {v:"C", t:"Konsum"},
     {v:"D", t:"Boden / nat√ºrliche Ressourcen"}
   ],
   correct:"C",
   explain:"Konsum ist die Verwendung von G√ºtern, kein Produktionsfaktor. Die klassischen Produktionsfaktoren sind Arbeit, Kapital und Boden (nat√ºrliche Ressourcen). Manchmal wird auch Wissen/Humankapital als vierter Faktor genannt."
  },
  {id:"d08", topic:"definition", type:"tf", diff:2, tax:"K2",
   q:"Wertsch√∂pfung entsteht, wenn die Outputs eines Unternehmens wertvoller sind als die eingesetzten Inputs.",
   correct: true,
   explain:"Richtig. Genau das ist das Prinzip der Wertsch√∂pfung: Unternehmen verwandeln Produktionsfaktoren (Inputs) in G√ºter und Dienstleistungen (Outputs), die einen h√∂heren Marktwert haben."
  },

  // ‚îÄ‚îÄ 2. WAS DAS BIP (NICHT) MISST ‚îÄ‚îÄ
  {id:"m01", topic:"messprobleme", type:"tf", diff:1, tax:"K2",
   q:"Wenn eine Familie ihre Kinder neu in eine Krippe schickt statt sie zu Hause zu betreuen, sinkt das BIP.",
   correct: false,
   explain:"Falsch. Das BIP steigt, weil die Krippenbetreuung als bezahlte Dienstleistung erfasst wird, w√§hrend die unbezahlte Betreuung zu Hause nicht im BIP erscheint."
  },
  {id:"m02", topic:"messprobleme", type:"tf", diff:1, tax:"K1",
   q:"Schwarzarbeit wird im offiziellen BIP nicht erfasst.",
   correct: true,
   explain:"Richtig. Schwarzarbeit wird nicht offiziell gemeldet und erscheint daher nicht in den amtlichen BIP-Statistiken."
  },
  {id:"m03", topic:"messprobleme", type:"tf", diff:2, tax:"K2",
   q:"Wenn ein Unwetter Br√ºcken zerst√∂rt und diese wieder aufgebaut werden, hat dies keinen Einfluss auf das BIP.",
   correct: false,
   explain:"Falsch. Der Wiederaufbau erzeugt neue Wertsch√∂pfung (Baut√§tigkeit, Materialien) und erh√∂ht das BIP. Paradoxerweise kann eine Naturkatastrophe das BIP kurzfristig steigern."
  },
  {id:"m04", topic:"messprobleme", type:"mc", diff:2, tax:"K3",
   q:"Seit 2014 sind Drogenhandel und Prostitution Bestandteil der volkswirtschaftlichen Gesamtrechnung der Schweiz. Eine Hanfanlage in Lenggenwil wird von der Polizei zerst√∂rt. Wie wirkt sich das auf das BIP aus?",
   options:[
     {v:"A", t:"Das BIP steigt, weil die Polizeiaktion Wertsch√∂pfung ist."},
     {v:"B", t:"Das BIP sinkt, weil die Produktion der Anlage wegf√§llt."},
     {v:"C", t:"Es gibt keinen Effekt, weil illegale Aktivit√§ten nicht im BIP erfasst werden."},
     {v:"D", t:"Das BIP sinkt kurzfristig (Produktionsausfall), profitiert aber vom Polizeieinsatz."}
   ],
   correct:"D",
   explain:"Die Drogenproduktion wurde im BIP erfasst und f√§llt nun weg (BIP sinkt). Gleichzeitig ist die Polizeiaktion eine staatliche Dienstleistung (BIP steigt). Per Saldo d√ºrfte das BIP sinken, da der Produktionswert der Anlage gr√∂sser war als der Polizeieinsatz."
  },
  {id:"m05", topic:"messprobleme", type:"mc", diff:2, tax:"K2",
   q:"Wikipedia hat kostenpflichtige Enzyklop√§dien weitgehend ersetzt. Welche Auswirkung hat das auf das BIP?",
   options:[
     {v:"A", t:"Das BIP steigt, weil mehr Menschen Zugang zu Wissen haben."},
     {v:"B", t:"Das BIP sinkt, weil eine bisher kostenpflichtige Leistung nun gratis ist."},
     {v:"C", t:"Kein Effekt, weil digitale G√ºter nicht im BIP erfasst werden."},
     {v:"D", t:"Das BIP steigt durch die Werbeeinnahmen von Wikipedia."}
   ],
   correct:"B",
   explain:"Wikipedia ist gratis und hat kostenpflichtige Enzyklop√§dien verdr√§ngt. Da das BIP nur G√ºter zu Marktpreisen misst, geht diese Wertsch√∂pfung verloren. Das BIP untersch√§tzt daher den Wohlstand, den kostenlose digitale Dienste schaffen. (Wikipedia finanziert sich durch Spenden, nicht Werbung.)"
  },
  {id:"m06", topic:"messprobleme", type:"mc", diff:3, tax:"K4",
   q:"Im ¬´Fall Fehr¬ª meldete ein Nationalrat seine Putzfrau nicht bei der Sozialversicherung an. Nachdem der Fall publik wurde, stieg die Zahl der Anmeldungen von Haushaltshilfen. Welche Auswirkung hatte das auf das BIP?",
   options:[
     {v:"A", t:"Das BIP sank, weil mehr Sozialversicherungsabgaben bezahlt werden mussten."},
     {v:"B", t:"Das BIP stieg, weil bisher nicht erfasste Arbeit nun offiziell gemeldet wurde."},
     {v:"C", t:"Kein Effekt, weil die Arbeit vorher und nachher gleich geleistet wurde."},
     {v:"D", t:"Das BIP stieg, weil neue Arbeitspl√§tze geschaffen wurden."}
   ],
   correct:"B",
   explain:"Die Putzarbeit wurde schon vorher geleistet ‚Äî aber als Schwarzarbeit. Durch die Anmeldung wird sie nun offiziell erfasst und erscheint im BIP. Das BIP steigt also statistisch, obwohl real dieselbe Arbeit verrichtet wird."
  },
  {id:"m07", topic:"messprobleme", type:"sort", diff:2, tax:"K2",
   q:"Ordnen Sie zu: Welche der folgenden Aktivit√§ten werden im BIP erfasst und welche nicht?",
   categories:["Im BIP erfasst", "Nicht im BIP erfasst"],
   items:[
     {t:"Kinderbetreuung in einer Krippe", cat:0},
     {t:"Kinderbetreuung durch die Eltern zu Hause", cat:1},
     {t:"Reparatur eines Autos in der Werkstatt", cat:0},
     {t:"Selbst durchgef√ºhrte Autoreparatur", cat:1},
     {t:"Kauf eines Brotes in der B√§ckerei", cat:0},
     {t:"Ehrenamtliche Arbeit im Verein", cat:1}
   ],
   explain:"Das BIP erfasst nur G√ºter und Dienstleistungen, die √ºber den Markt gehandelt werden (also einen Preis haben). Unbezahlte Arbeit ‚Äî Hausarbeit, Eigenleistungen, Ehrenamt ‚Äî erscheint nicht im BIP."
  },
  {id:"m08", topic:"messprobleme", type:"mc", diff:3, tax:"K5",
   q:"¬´Das BIP eines Landes steigt. Also geht es den Menschen in diesem Land besser.¬ª ‚Äî Beurteilen Sie diese Aussage.",
   options:[
     {v:"A", t:"Die Aussage ist korrekt ‚Äî ein steigendes BIP bedeutet immer mehr Wohlstand."},
     {v:"B", t:"Die Aussage ist teilweise richtig ‚Äî das BIP misst nur den materiellen Wohlstand und vernachl√§ssigt z.B. Verteilung, Umwelt und unbezahlte Arbeit."},
     {v:"C", t:"Die Aussage ist falsch ‚Äî das BIP hat nichts mit Wohlstand zu tun."},
     {v:"D", t:"Die Aussage ist nur richtig, wenn das BIP pro Kopf steigt."}
   ],
   correct:"B",
   explain:"Das BIP ist ein n√ºtzlicher, aber begrenzter Wohlstandsindikator. Es misst die wirtschaftliche Gesamtleistung, vernachl√§ssigt aber Verteilungsaspekte, Umweltsch√§den, unbezahlte Arbeit, Freizeit und Lebensqualit√§t."
  },

  // ‚îÄ‚îÄ 3. DREI SEITEN DES BIP ‚îÄ‚îÄ
  {id:"s01", topic:"dreiseiten", type:"fill", diff:1, tax:"K1",
   q:"Das BIP kann auf drei Arten berechnet werden: Die {0} addiert die Wertsch√∂pfung aller Unternehmen. Die {1} berechnet das BIP als Summe von Konsum, Staatsausgaben, Investitionen und Nettoexporten. Die {2} addiert alle L√∂hne und Gewinne.",
   blanks:[
     {answer:"Produktionsseite", alts:["Entstehungsseite", "produktionsseite", "entstehungsseite"]},
     {answer:"Verwendungsseite", alts:["verwendungsseite"]},
     {answer:"Verteilungsseite", alts:["Einkommensseite", "verteilungsseite", "einkommensseite"]}
   ],
   explain:"Die drei Seiten des BIP: Produktionsseite (Wertsch√∂pfung), Verwendungsseite (Konsum + Staat + Investitionen + Nettoexporte), Verteilungsseite (L√∂hne + Gewinne). Alle drei ergeben per Definition denselben Wert."
  },
  {id:"s02", topic:"dreiseiten", type:"mc", diff:1, tax:"K1",
   q:"Auf welcher Seite des BIP erscheinen die Konsumausgaben der Haushalte?",
   options:[
     {v:"A", t:"Produktionsseite"},
     {v:"B", t:"Verwendungsseite"},
     {v:"C", t:"Verteilungsseite"},
     {v:"D", t:"Auf allen drei Seiten"}
   ],
   correct:"B",
   explain:"Die Konsumausgaben sind Teil der Verwendungsseite: BIP = Konsum (C) + Staatsausgaben (G) + Investitionen (I) + Nettoexporte (NX)."
  },
  {id:"s03", topic:"dreiseiten", type:"tf", diff:1, tax:"K2",
   q:"Die drei Seiten des BIP ergeben immer denselben Wert.",
   correct: true,
   explain:"Richtig. Per Definition m√ºssen alle drei Seiten gleich gross sein: Was produziert wird (Produktionsseite), wird von jemandem verwendet (Verwendungsseite) und geh√∂rt als Einkommen jemandem (Verteilungsseite)."
  },
  {id:"s04", topic:"dreiseiten", type:"mc", diff:2, tax:"K2",
   q:"Frau Studer arbeitet als Verk√§uferin im Globus (Lohn CHF 2800/Mt.) und kauft sich dort eine Bluse f√ºr CHF 70. Wo erscheint der Kauf der Bluse in den drei Seiten des BIP?",
   options:[
     {v:"A", t:"Nur auf der Produktionsseite (der Globus hat die Bluse 'produziert')."},
     {v:"B", t:"Nur auf der Verwendungsseite (Frau Studer konsumiert die Bluse)."},
     {v:"C", t:"Auf allen drei Seiten: Produktion (Handel), Verwendung (Konsum), Verteilung (Gewinn des Globus)."},
     {v:"D", t:"Nur auf der Verteilungsseite (der Globus macht Gewinn)."}
   ],
   correct:"C",
   explain:"Jede wirtschaftliche Transaktion erscheint auf allen drei Seiten: Der Globus erbringt eine Handelsleistung (Produktionsseite), Frau Studer konsumiert (Verwendungsseite), und der Erl√∂s wird als Lohn und Gewinn verteilt (Verteilungsseite)."
  },
  {id:"s05", topic:"dreiseiten", type:"sort", diff:2, tax:"K2",
   q:"Ordnen Sie die folgenden Komponenten der richtigen BIP-Seite zu.",
   categories:["Produktionsseite", "Verwendungsseite", "Verteilungsseite"],
   items:[
     {t:"Wertsch√∂pfung der Banken", cat:0},
     {t:"Konsumausgaben der Haushalte", cat:1},
     {t:"L√∂hne der Arbeitnehmenden", cat:2},
     {t:"Investitionen der Unternehmen", cat:1},
     {t:"Gewinne der Unternehmen", cat:2},
     {t:"Wertsch√∂pfung der Industrie", cat:0}
   ],
   explain:"Produktionsseite: Wertsch√∂pfung nach Branchen. Verwendungsseite: Konsum, Investitionen, Staatsausgaben, Nettoexporte. Verteilungsseite: L√∂hne und Gewinne."
  },
  {id:"s06", topic:"dreiseiten", type:"mc", diff:2, tax:"K2",
   q:"Welche Formel beschreibt die Verwendungsseite des BIP korrekt?",
   options:[
     {v:"A", t:"BIP = L√∂hne + Gewinne + Abschreibungen"},
     {v:"B", t:"BIP = C + G + I + (Exporte ‚àí Importe)"},
     {v:"C", t:"BIP = Gesamtproduktion ‚àí Vorleistungen"},
     {v:"D", t:"BIP = Konsum + Steuern + Sparen"}
   ],
   correct:"B",
   explain:"Verwendungsseite: BIP = C (privater Konsum) + G (Staatsausgaben) + I (Investitionen) + NX (Nettoexporte = Exporte ‚àí Importe). Antwort A ist die Verteilungsseite, C die Produktionsseite."
  },

  // ‚îÄ‚îÄ 4. NOMINAL vs. REAL ‚îÄ‚îÄ
  {id:"n01", topic:"nomreal", type:"tf", diff:1, tax:"K1",
   q:"Das reale BIP ist um die Preisentwicklung (Inflation) bereinigt.",
   correct: true,
   explain:"Richtig. Das reale BIP wird zu Preisen eines Basisjahres berechnet und zeigt, ob tats√§chlich mehr produziert wurde ‚Äî unabh√§ngig von Preis√§nderungen."
  },
  {id:"n02", topic:"nomreal", type:"mc", diff:1, tax:"K2",
   q:"Das nominale BIP eines Landes steigt um 5%, die Inflation betr√§gt 3%. Wie hoch ist ungef√§hr das reale Wirtschaftswachstum?",
   options:[
     {v:"A", t:"8%"},
     {v:"B", t:"5%"},
     {v:"C", t:"2%"},
     {v:"D", t:"3%"}
   ],
   correct:"C",
   explain:"Reales Wachstum ‚âà nominales Wachstum ‚àí Inflation = 5% ‚àí 3% = 2%. Die Wirtschaft ist real nur um 2% gewachsen, die restlichen 3% Anstieg sind bloss h√∂here Preise."
  },
  {id:"n03", topic:"nomreal", type:"calc", diff:2, tax:"K3",
   q:"Berechnen Sie das ungef√§hre reale Wirtschaftswachstum f√ºr die folgenden Jahre. Formel: Reales Wachstum ‚âà Nominales Wachstum ‚àí Inflation.",
   rows:[
     {label:"2023: Nom. 4.5%, Infl. 2.0%", answer:2.5, tolerance:0.2, unit:"%"},
     {label:"2024: Nom. 3.0%, Infl. 3.5%", answer:-0.5, tolerance:0.2, unit:"%"},
     {label:"2025: Nom. 1.2%, Infl. ‚àí0.3%", answer:1.5, tolerance:0.2, unit:"%"}
   ],
   explain:"2023: 4.5% ‚àí 2.0% = 2.5% | 2024: 3.0% ‚àí 3.5% = ‚àí0.5% (reale Schrumpfung!) | 2025: 1.2% ‚àí (‚àí0.3%) = 1.5% (bei Deflation wird das reale Wachstum gr√∂sser als das nominale)."
  },
  {id:"n04", topic:"nomreal", type:"tf", diff:2, tax:"K2",
   q:"Bei Deflation (negative Inflation) ist das reale BIP-Wachstum kleiner als das nominale BIP-Wachstum.",
   correct: false,
   explain:"Falsch. Bei Deflation ist es umgekehrt: Das reale Wachstum ist gr√∂sser als das nominale. Beispiel: Nom. Wachstum 1%, Inflation ‚àí2% ‚Üí reales Wachstum ‚âà 1% ‚àí (‚àí2%) = 3%."
  },
  {id:"n05", topic:"nomreal", type:"mc", diff:3, tax:"K4",
   q:"Land A meldet ein nominales BIP-Wachstum von 8% und eine Inflation von 7%. Land B meldet ein nominales Wachstum von 2% bei 0% Inflation. Welches Land hat real st√§rker gewachsen?",
   options:[
     {v:"A", t:"Land A (8% nominales Wachstum ist beeindruckend)."},
     {v:"B", t:"Land B (2% reales Wachstum > 1% reales Wachstum in Land A)."},
     {v:"C", t:"Beide gleich (8% ‚àí 7% = 1% und 2% ‚àí 0% = 2%)."},
     {v:"D", t:"Das l√§sst sich nicht vergleichen."}
   ],
   correct:"B",
   explain:"Land A: reales Wachstum ‚âà 8% ‚àí 7% = 1%. Land B: reales Wachstum ‚âà 2% ‚àí 0% = 2%. Land B ist real st√§rker gewachsen, obwohl das nominale Wachstum viel tiefer war."
  },

  // ‚îÄ‚îÄ 5. INTERNATIONALER VERGLEICH / PPP ‚îÄ‚îÄ
  {id:"p01", topic:"ppp", type:"mc", diff:2, tax:"K2",
   q:"Was messen Kaufkraftparit√§ten (PPP)?",
   options:[
     {v:"A", t:"Den Wechselkurs zwischen zwei W√§hrungen."},
     {v:"B", t:"Wie viel man sich mit dem gleichen Geldbetrag in verschiedenen L√§ndern leisten kann."},
     {v:"C", t:"Die Differenz zwischen nominalem und realem BIP."},
     {v:"D", t:"Die Handelsbilanz zwischen zwei L√§ndern."}
   ],
   correct:"B",
   explain:"PPP korrigiert daf√ºr, dass dieselben G√ºter in verschiedenen L√§ndern unterschiedlich viel kosten. Die Idee: Wie viel Geld br√§uchte man in den USA, um sich dieselben G√ºter leisten zu k√∂nnen?"
  },
  {id:"p02", topic:"ppp", type:"tf", diff:2, tax:"K2",
   q:"Das BIP pro Kopf der Schweiz sinkt, wenn es f√ºr Kaufkraftparit√§ten (PPP) korrigiert wird.",
   correct: true,
   explain:"Richtig. Die Lebenshaltungskosten in der Schweiz sind deutlich h√∂her als in den USA (Referenzland). Ein Haarschnitt, ein Mittagessen oder eine Wohnung kosten mehr. Die Kaufkraft des Schweizer BIP ist daher geringer als der nominale Wert vermuten l√§sst."
  },
  {id:"p03", topic:"ppp", type:"mc", diff:2, tax:"K3",
   q:"Indien hat ein tiefes BIP pro Kopf, aber ein relativ h√∂heres BIP pro Kopf in PPP. Was bedeutet das?",
   options:[
     {v:"A", t:"Indien exportiert viel mehr als es importiert."},
     {v:"B", t:"Die Lebenshaltungskosten in Indien sind tiefer als in den USA ‚Äî man kann sich mit weniger Geld mehr leisten."},
     {v:"C", t:"Die indische Rupie ist √ºberbewertet."},
     {v:"D", t:"Indiens Wirtschaft w√§chst schneller als die der USA."}
   ],
   correct:"B",
   explain:"In Indien sind viele G√ºter und Dienstleistungen viel g√ºnstiger als in den USA. Ein Haarschnitt kostet z.B. nur einen Bruchteil. Deshalb steigt das BIP pro Kopf in PPP: Die Menschen k√∂nnen sich mit ihrem Einkommen relativ mehr leisten."
  },
  {id:"p04", topic:"ppp", type:"tf", diff:3, tax:"K4",
   q:"Ein Vergleich des BIP pro Kopf verschiedener L√§nder in derselben W√§hrung (z.B. US-Dollar) reicht aus, um den Wohlstand der Bev√∂lkerung zu vergleichen.",
   correct: false,
   explain:"Falsch. Der blosse W√§hrungsumtausch ber√ºcksichtigt nicht die unterschiedlichen Preisniveaus. In einem Land mit tiefen Lebenshaltungskosten reicht ein kleineres BIP weiter. F√ºr einen aussagekr√§ftigen Vergleich braucht man PPP-Korrekturen ‚Äî und selbst dann erfasst man nicht alles (Verteilung, Umwelt, Lebensqualit√§t)."
  },

  // ‚îÄ‚îÄ 6. WIRTSCHAFTSKREISLAUF ‚îÄ‚îÄ
  {id:"k01", topic:"kreislauf", type:"mc", diff:1, tax:"K1",
   q:"Im einfachen Wirtschaftskreislauf gibt es zwei Akteure. Welche?",
   options:[
     {v:"A", t:"Staat und Banken"},
     {v:"B", t:"Haushalte und Unternehmen"},
     {v:"C", t:"Unternehmen und Ausland"},
     {v:"D", t:"Haushalte und Staat"}
   ],
   correct:"B",
   explain:"Der einfache Wirtschaftskreislauf besteht aus Haushalten und Unternehmen. Haushalte bieten Produktionsfaktoren an (Arbeit) und konsumieren G√ºter. Unternehmen produzieren G√ºter und bezahlen L√∂hne."
  },
  {id:"k02", topic:"kreislauf", type:"sort", diff:2, tax:"K2",
   q:"Ordnen Sie die folgenden Str√∂me dem G√ºterkreislauf oder dem Geldkreislauf zu.",
   categories:["G√ºterkreislauf", "Geldkreislauf"],
   items:[
     {t:"Arbeitskraft der Haushalte", cat:0},
     {t:"L√∂hne der Unternehmen", cat:1},
     {t:"Waren im Laden", cat:0},
     {t:"Konsumausgaben der Haushalte", cat:1},
     {t:"Dienstleistung eines Handwerkers", cat:0},
     {t:"Mietzahlung", cat:1}
   ],
   explain:"Im Wirtschaftskreislauf fliessen G√ºter/Dienstleistungen/Arbeit in eine Richtung (G√ºterkreislauf) und Geld in die entgegengesetzte Richtung (Geldkreislauf). Jeder G√ºterstrom hat einen entsprechenden Geldstrom."
  },
  {id:"k03", topic:"kreislauf", type:"mc", diff:2, tax:"K2",
   q:"Welche zus√§tzlichen Akteure kommen im erweiterten Wirtschaftskreislauf hinzu?",
   options:[
     {v:"A", t:"Nur der Staat"},
     {v:"B", t:"Staat, Banken und Ausland"},
     {v:"C", t:"Banken und Versicherungen"},
     {v:"D", t:"Staat und Ausland"}
   ],
   correct:"B",
   explain:"Der erweiterte Wirtschaftskreislauf erg√§nzt den einfachen um drei Akteure: den Staat (Steuern, Staatsausgaben), die Banken (Sparen, Kredite) und das Ausland (Importe, Exporte)."
  },
  {id:"k04", topic:"kreislauf", type:"tf", diff:2, tax:"K2",
   q:"Im Wirtschaftskreislauf fliesst Geld immer in dieselbe Richtung wie G√ºter.",
   correct: false,
   explain:"Falsch. G√ºter und Geld fliessen in entgegengesetzte Richtungen. Wenn ein Haushalt ein Brot kauft, fliesst das Brot zum Haushalt und das Geld zum Unternehmen."
  },
  {id:"k05", topic:"kreislauf", type:"mc", diff:3, tax:"K4",
   q:"Zwischen 1962 und 1988 nahm in den USA die Zahl der Erwerbspersonen um 71% zu (Babyboom, Frauenerwerbst√§tigkeit). Die Zahl der Arbeitspl√§tze stieg fast gleich stark. Wie erkl√§rt der Wirtschaftskreislauf das?",
   options:[
     {v:"A", t:"Reiner Zufall ‚Äî der Arbeitsmarkt ist unabh√§ngig von der Bev√∂lkerung."},
     {v:"B", t:"Mehr Besch√§ftigte ‚Üí mehr Einkommen ‚Üí mehr Konsum ‚Üí Unternehmen brauchen mehr Arbeitskr√§fte."},
     {v:"C", t:"Der Staat hat gen√ºgend Stellen geschaffen."},
     {v:"D", t:"Die USA haben mehr importiert und so Arbeitspl√§tze geschaffen."}
   ],
   correct:"B",
   explain:"Der Wirtschaftskreislauf zeigt: Mehr Arbeit auf den Faktorm√§rkten ‚Üí h√∂heres Einkommen der Haushalte ‚Üí mehr Ausgaben auf den G√ºterm√§rkten ‚Üí Unternehmen m√ºssen mehr produzieren ‚Üí sie stellen mehr Arbeitskr√§fte ein. Die Zahl der Arbeitspl√§tze ist keine feste Gr√∂sse."
  },

  // ‚îÄ‚îÄ 7. VERTEILUNG & UMVERTEILUNG ‚îÄ‚îÄ
  {id:"v01", topic:"verteilung", type:"mc", diff:1, tax:"K1",
   q:"Was ist der Unterschied zwischen Prim√§reinkommen und verf√ºgbarem Einkommen?",
   options:[
     {v:"A", t:"Es gibt keinen Unterschied ‚Äî beide Begriffe meinen dasselbe."},
     {v:"B", t:"Das Prim√§reinkommen ist das Bruttoeinkommen; das verf√ºgbare Einkommen ist das, was nach staatlicher Umverteilung (Steuern, Transfers) √ºbrig bleibt."},
     {v:"C", t:"Das Prim√§reinkommen ist nur Lohn, das verf√ºgbare Einkommen schliesst auch Kapitalertr√§ge ein."},
     {v:"D", t:"Das verf√ºgbare Einkommen ist immer h√∂her als das Prim√§reinkommen."}
   ],
   correct:"B",
   explain:"Das Prim√§reinkommen (Markteinkommen) ist das Einkommen vor staatlicher Umverteilung. Das verf√ºgbare Einkommen ist das, was nach Steuern und Transfers (Sozialhilfe, AHV etc.) √ºbrig bleibt."
  },
  {id:"v02", topic:"verteilung", type:"tf", diff:1, tax:"K1",
   q:"Der Gini-Koeffizient misst die Ungleichheit der Einkommens- oder Verm√∂gensverteilung.",
   correct: true,
   explain:"Richtig. Der Gini-Koeffizient reicht von 0 (perfekte Gleichheit) bis 1 (maximale Ungleichheit). Er wird aus der Lorenzkurve abgeleitet."
  },
  {id:"v03", topic:"verteilung", type:"mc", diff:2, tax:"K2",
   q:"Was zeigt die Lorenzkurve?",
   options:[
     {v:"A", t:"Die Entwicklung des BIP √ºber die Zeit."},
     {v:"B", t:"Den Zusammenhang zwischen kumuliertem Bev√∂lkerungsanteil und kumuliertem Einkommensanteil."},
     {v:"C", t:"Die Inflation im Verh√§ltnis zur Arbeitslosigkeit."},
     {v:"D", t:"Die Aufteilung des BIP auf die drei Seiten."}
   ],
   correct:"B",
   explain:"Die Lorenzkurve zeigt, welcher Anteil des Gesamteinkommens auf welchen Anteil der Bev√∂lkerung entf√§llt. Bei perfekter Gleichheit w√§re sie eine 45¬∞-Linie. Je st√§rker sie davon abweicht, desto ungleicher die Verteilung."
  },
  {id:"v04", topic:"verteilung", type:"tf", diff:2, tax:"K2",
   q:"Die Verm√∂gensverteilung in der Schweiz ist deutlich ungleicher als die Einkommensverteilung.",
   correct: true,
   explain:"Richtig. In der Schweiz (und weltweit) ist die Verteilung der Verm√∂gen viel ungleicher als die der Einkommen. Der Staat greift bei der Einkommensverteilung st√§rker umverteilend ein (progressive Steuern, Transfers), w√§hrend die Verm√∂gensverteilung kaum angetastet wird."
  },
  {id:"v05", topic:"verteilung", type:"mc", diff:3, tax:"K5",
   q:"¬´Umverteilung durch den Staat schadet der Wirtschaft, weil sie die Leistungsanreize verringert.¬ª Welche Aussage differenziert diese Position am besten?",
   options:[
     {v:"A", t:"Die Aussage ist immer richtig ‚Äî Steuern zerst√∂ren jeden Anreiz."},
     {v:"B", t:"Die Laffer-Kurve zeigt, dass es ein Optimum gibt: Zu hohe und zu niedrige Steuern k√∂nnen beide ineffizient sein."},
     {v:"C", t:"Umverteilung hat keinerlei Auswirkung auf Anreize."},
     {v:"D", t:"Nur Verm√∂genssteuern reduzieren Anreize, Einkommenssteuern nicht."}
   ],
   correct:"B",
   explain:"Die Laffer-Kurve verdeutlicht, dass es einen optimalen Steuersatz gibt: Bei 0% hat der Staat keine Einnahmen, bei 100% hat niemand einen Anreiz zu arbeiten (also auch keine Einnahmen). Dazwischen gibt es ein Optimum. Die Frage ist, wo eine Gesellschaft auf dieser Kurve steht."
  },
  {id:"v06", topic:"verteilung", type:"sort", diff:2, tax:"K2",
   q:"Ordnen Sie die Argumente: Welche sprechen F√úR Umverteilung und welche DAGEGEN?",
   categories:["F√ºr Umverteilung", "Gegen Umverteilung"],
   items:[
     {t:"Fairness und sozialer Zusammenhalt", cat:0},
     {t:"Reduktion von Leistungsanreizen", cat:1},
     {t:"Bek√§mpfung von Armut", cat:0},
     {t:"B√ºrokratiekosten der Umverteilung", cat:1},
     {t:"Chancengleichheit durch Bildung", cat:0},
     {t:"Gefahr des Rent-Seeking / Lobbying", cat:1}
   ],
   explain:"F√ºr Umverteilung sprechen Fairness, Armutsbek√§mpfung und Chancengleichheit. Dagegen sprechen reduzierte Leistungsanreize (Laffer-Kurve), B√ºrokratiekosten und die Gefahr, dass Umverteilung zu politischem Rent-Seeking f√ºhrt."
  },

  // ‚îÄ‚îÄ Zus√§tzliche Fragen √ºber alle Themen ‚îÄ‚îÄ
  {id:"x01", topic:"definition", type:"mc", diff:3, tax:"K4",
   q:"Ein Land hat ein hohes BIP, aber die Mehrheit der Bev√∂lkerung lebt in Armut. Welche Erkl√§rung ist am plausibelsten?",
   options:[
     {v:"A", t:"Das BIP wird falsch berechnet."},
     {v:"B", t:"Das Einkommen ist sehr ungleich verteilt ‚Äî wenige Reiche treiben das BIP hoch."},
     {v:"C", t:"Das BIP pro Kopf muss tief sein."},
     {v:"D", t:"Die Inflation ist sehr hoch."}
   ],
   correct:"B",
   explain:"Ein hohes Gesamt-BIP sagt nichts √ºber die Verteilung aus. Wenn wenige Personen oder Unternehmen den Grossteil der Wertsch√∂pfung kontrollieren, kann die breite Bev√∂lkerung trotzdem arm sein. Deshalb ist das BIP pro Kopf aussagekr√§ftiger ‚Äî und selbst dieses verschleiert die Verteilung."
  },
  {id:"x02", topic:"nomreal", type:"tf", diff:1, tax:"K1",
   q:"Wenn das nominale BIP steigt, muss auch die reale Wirtschaftsleistung gestiegen sein.",
   correct: false,
   explain:"Falsch. Das nominale BIP kann allein durch steigende Preise (Inflation) zunehmen, ohne dass real mehr produziert wird. Deshalb ist das reale BIP der bessere Indikator f√ºr tats√§chliches Wirtschaftswachstum."
  },
  {id:"x03", topic:"messprobleme", type:"tf", diff:2, tax:"K3",
   q:"Die Nutzung von YouTube (gratis) steigert das BIP.",
   correct: false,
   explain:"Falsch. YouTube ist f√ºr die Nutzenden kostenlos. Da das BIP G√ºter zu Marktpreisen misst, erscheint die Nutzung nicht im BIP (obwohl sie einen Nutzen stiftet). Nur die Werbeeinnahmen von YouTube z√§hlen zum BIP."
  },
  {id:"x04", topic:"kreislauf", type:"tf", diff:1, tax:"K1",
   q:"Im einfachen Wirtschaftskreislauf gibt es einen G√ºter- und einen Geldkreislauf.",
   correct: true,
   explain:"Richtig. G√ºter (Waren, Dienstleistungen, Arbeit) und Geld (L√∂hne, Konsumausgaben) fliessen in entgegengesetzten Richtungen zwischen Haushalten und Unternehmen."
  },
  {id:"x05", topic:"dreiseiten", type:"tf", diff:2, tax:"K2",
   q:"Exporte erh√∂hen das BIP auf der Verwendungsseite, Importe senken es.",
   correct: true,
   explain:"Richtig. Auf der Verwendungsseite gilt: BIP = C + G + I + (Exporte ‚àí Importe). Exporte sind G√ºter, die im Inland produziert aber im Ausland verwendet werden (z√§hlen zum BIP). Importe sind im Ausland produziert und m√ºssen abgezogen werden."
  },
  {id:"x06", topic:"ppp", type:"mc", diff:1, tax:"K1",
   q:"Was bedeutet die Abk√ºrzung PPP im Zusammenhang mit dem BIP?",
   options:[
     {v:"A", t:"Public-Private Partnership"},
     {v:"B", t:"Purchasing Power Parity (Kaufkraftparit√§t)"},
     {v:"C", t:"Price Per Product"},
     {v:"D", t:"Profit Per Person"}
   ],
   correct:"B",
   explain:"PPP steht f√ºr Purchasing Power Parity (Kaufkraftparit√§t) und dient dazu, das BIP verschiedener L√§nder unter Ber√ºcksichtigung der unterschiedlichen Preisniveaus vergleichbar zu machen."
  },
  {id:"x07", topic:"verteilung", type:"mc", diff:2, tax:"K2",
   q:"Ein Gini-Koeffizient von 0.25 bedeutet:",
   options:[
     {v:"A", t:"Maximale Ungleichheit ‚Äî eine Person besitzt alles."},
     {v:"B", t:"Relativ gleichm√§ssige Verteilung."},
     {v:"C", t:"Genau 25% der Bev√∂lkerung besitzen 75% des Einkommens."},
     {v:"D", t:"Die H√§lfte der Bev√∂lkerung lebt unter der Armutsgrenze."}
   ],
   correct:"B",
   explain:"Der Gini-Koeffizient reicht von 0 (perfekte Gleichheit) bis 1 (maximale Ungleichheit). Ein Wert von 0.25 zeigt eine relativ gleichm√§ssige Verteilung an. Die Schweiz hat einen Gini-Koeffizient von ca. 0.33 (nach Umverteilung)."
  }
];

// ‚îÄ‚îÄ Topic metadata ‚îÄ‚îÄ
const TOPICS = {
  definition: {label:"Definition & Grundbegriffe", short:"Definition"},
  messprobleme: {label:"Was das BIP (nicht) misst", short:"Messprobleme"},
  dreiseiten: {label:"Drei Seiten des BIP", short:"3 Seiten"},
  nomreal: {label:"Nominales vs. reales BIP", short:"Nominal/Real"},
  ppp: {label:"Internationaler Vergleich / PPP", short:"PPP"},
  kreislauf: {label:"Wirtschaftskreislauf", short:"Kreislauf"},
  verteilung: {label:"Verteilung & Umverteilung", short:"Verteilung"}
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// APP STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let state = {
  mode: 'fokus',
  filters: { topics: [], diffs: [1,2,3], types: ['mc','tf','fill','calc','sort'] },
  queue: [],
  current: 0,
  score: 0,
  maxScore: 0,
  answered: [],
  wrong: []
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function init() {
  // Build topic chips
  const topicChips = document.getElementById('topicChips');
  for (const [key, val] of Object.entries(TOPICS)) {
    const count = QUESTIONS.filter(q => q.topic === key).length;
    const chip = document.createElement('div');
    chip.className = 'chip';
    chip.dataset.topic = key;
    chip.innerHTML = val.short + ' <span class="chip-count">' + count + '</span>';
    chip.onclick = function() { toggleChip(this, 'topic'); };
    topicChips.appendChild(chip);
  }
  updateQuestionCount();
}

function selectMode(el) {
  document.querySelectorAll('.mode-card').forEach(c => c.classList.remove('selected'));
  el.classList.add('selected');
  state.mode = el.dataset.mode;
  applyModeDefaults();
  updateQuestionCount();
}

function applyModeDefaults() {
  if (state.mode === 'fokus') {
    // Fokus: Thema und Schwierigkeit m√ºssen gew√§hlt werden, Fragetypen bleiben alle an
    document.querySelectorAll('#topicChips .chip').forEach(c => c.classList.remove('selected'));
    document.querySelectorAll('#diffChips .chip').forEach(c => c.classList.remove('selected'));
    document.querySelectorAll('#typeChips .chip').forEach(c => c.classList.add('selected'));
  } else {
    // Mix: alles angew√§hlt
    document.querySelectorAll('#topicChips .chip').forEach(c => c.classList.add('selected'));
    document.querySelectorAll('#diffChips .chip').forEach(c => c.classList.add('selected'));
    document.querySelectorAll('#typeChips .chip').forEach(c => c.classList.add('selected'));
  }
}

function toggleChip(el, group) {
  el.classList.toggle('selected');
  updateQuestionCount();
}

function getSelectedFilters() {
  const topics = [...document.querySelectorAll('#topicChips .chip.selected')].map(c => c.dataset.topic);
  const diffs = [...document.querySelectorAll('#diffChips .chip.selected')].map(c => parseInt(c.dataset.diff));
  const types = [...document.querySelectorAll('#typeChips .chip.selected')].map(c => c.dataset.type);
  return {topics, diffs, types};
}

function getFilteredQuestions() {
  const f = getSelectedFilters();
  return QUESTIONS.filter(q =>
    f.topics.includes(q.topic) &&
    f.diffs.includes(q.diff) &&
    f.types.includes(q.type)
  );
}

function updateQuestionCount() {
  const filtered = getFilteredQuestions();
  const info = document.getElementById('questionCountInfo');
  const btn = document.getElementById('startBtn');
  if (filtered.length === 0) {
    info.textContent = 'Keine Aufgaben mit diesen Filtern verf√ºgbar.';
    btn.disabled = true;
  } else {
    info.textContent = filtered.length + ' Aufgaben verf√ºgbar ‚Äî Sie k√∂nnen jederzeit aufh√∂ren.';
    btn.disabled = false;
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// QUIZ LOGIC
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function startQuiz() {
  let pool = getFilteredQuestions();
  if (pool.length === 0) return;

  if (state.mode === 'fokus') {
    // Sort by difficulty, then by topic
    pool.sort((a, b) => a.diff - b.diff || a.id.localeCompare(b.id));
  } else {
    // Shuffle for mix mode
    pool = shuffle([...pool]);
  }

  state.queue = pool;
  state.current = 0;
  state.score = 0;
  state.maxScore = 0;
  state.answered = [];
  state.wrong = [];

  showScreen('quizScreen');
  renderQuestion();
}

function renderQuestion() {
  const q = state.queue[state.current];
  const total = state.queue.length;
  document.getElementById('quizCounter').textContent = 'Aufgabe ' + (state.current + 1) + ' / ' + total;
  document.getElementById('quizScore').textContent = state.score + ' Punkt' + (state.score !== 1 ? 'e' : '');
  document.getElementById('quizProgressFill').style.width = ((state.current / total) * 100) + '%';

  const diffLabels = {1:'Einfach', 2:'Mittel', 3:'Schwer'};
  const typeLabels = {mc:'Multiple Choice', tf:'Richtig/Falsch', fill:'L√ºckentext', calc:'Berechnung', sort:'Zuordnung'};

  let html = '<div class="q-card" id="currentQ">';
  html += '<div class="q-badges">';
  html += '<span class="q-badge badge-topic">' + TOPICS[q.topic].short + '</span>';
  html += '<span class="q-badge badge-diff-' + q.diff + '">' + diffLabels[q.diff] + '</span>';
  html += '<span class="q-badge badge-type">' + typeLabels[q.type] + '</span>';
  html += '<span class="q-badge badge-tax">' + q.tax + '</span>';
  html += '</div>';

  if (q.type === 'mc') {
    html += '<div class="q-text">' + q.q + '</div>';
    html += '<div class="q-options" id="qOpts">';
    q.options.forEach(o => {
      html += '<div class="q-opt" data-value="' + o.v + '" onclick="selectOpt(this)">';
      html += '<div class="q-opt-marker">' + o.v + '</div>';
      html += '<div>' + o.t + '</div></div>';
    });
    html += '</div>';
    html += '<div class="btn-row"><button class="btn btn-check" onclick="checkMCQ()">√úberpr√ºfen</button></div>';
  }
  else if (q.type === 'tf') {
    html += '<div class="q-text">' + q.q + '</div>';
    html += '<div class="q-options" id="qOpts">';
    html += '<div class="q-opt" data-value="true" onclick="selectOpt(this)"><div class="q-opt-marker">R</div><div>Richtig</div></div>';
    html += '<div class="q-opt" data-value="false" onclick="selectOpt(this)"><div class="q-opt-marker">F</div><div>Falsch</div></div>';
    html += '</div>';
    html += '<div class="btn-row"><button class="btn btn-check" onclick="checkTFQ()">√úberpr√ºfen</button></div>';
  }
  else if (q.type === 'fill') {
    let text = q.q;
    q.blanks.forEach((b, i) => {
      text = text.replace('{' + i + '}', '<input class="q-fill-input" data-idx="' + i + '" placeholder="‚Ä¶">');
    });
    html += '<div class="q-text" style="font-weight:400; line-height:2.2;">' + text + '</div>';
    html += '<div class="btn-row"><button class="btn btn-check" onclick="checkFillQ()">√úberpr√ºfen</button></div>';
  }
  else if (q.type === 'calc') {
    html += '<div class="q-text">' + q.q + '</div>';
    html += '<div style="display:flex; flex-direction:column; gap:10px;">';
    q.rows.forEach((r, i) => {
      html += '<div style="display:flex; align-items:center; gap:10px; font-size:0.92rem; flex-wrap:wrap;">';
      html += '<span style="min-width:200px;">' + r.label + '</span>';
      html += '<input class="q-calc-input" data-idx="' + i + '" placeholder="?"> <span>' + (r.unit || '') + '</span>';
      html += '</div>';
    });
    html += '</div>';
    html += '<div class="btn-row"><button class="btn btn-check" onclick="checkCalcQ()">√úberpr√ºfen</button></div>';
  }
  else if (q.type === 'sort') {
    html += '<div class="q-text">' + q.q + '</div>';
    html += '<p style="font-size:0.82rem; color:var(--c-text-soft); margin-bottom:14px;">W√§hlen Sie einen Begriff aus, dann klicken Sie auf die Kategorie, in die er geh√∂rt.</p>';
    html += '<div id="sortArea">';
    // Pool first
    html += '<div class="filter-label">Begriffe</div>';
    html += '<div id="sortPool" style="display:flex; flex-wrap:wrap; gap:6px; padding:10px; border:2px solid var(--c-border); border-radius:8px; min-height:44px; margin-bottom:14px; background:#f8fafc;">';
    const shuffled = shuffle([...q.items]);
    shuffled.forEach((item, i) => {
      html += '<div class="chip" data-sort-idx="' + q.items.indexOf(item) + '" onclick="selectSortItem(this)" style="cursor:pointer;">' + item.t + '</div>';
    });
    html += '</div>';
    // Render categories
    q.categories.forEach((cat, ci) => {
      html += '<div style="margin-bottom:10px;">';
      html += '<div class="filter-label">' + cat + '</div>';
      html += '<div class="sort-drop" data-cat="' + ci + '" onclick="placeSortItem(this)" style="min-height:44px; padding:10px; border:2px dashed var(--c-border); border-radius:8px; display:flex; flex-wrap:wrap; gap:6px; cursor:pointer; transition: border-color 0.15s; background:white;"></div>';
      html += '</div>';
    });
    html += '</div>';
    html += '<div class="btn-row"><button class="btn btn-check" onclick="checkSortQ()">√úberpr√ºfen</button></div>';
  }

  html += '<div class="q-feedback" id="qFeedback"></div>';
  html += '<div class="btn-row" id="nextRow" style="display:none;">';
  if (state.current < state.queue.length - 1) {
    html += '<button class="btn btn-next" onclick="nextQuestion()">N√§chste Aufgabe ‚Üí</button>';
  } else {
    html += '<button class="btn btn-next" onclick="endQuiz()">Auswertung anzeigen ‚Üí</button>';
  }
  html += '</div>';
  html += '</div>';

  document.getElementById('quizContent').innerHTML = html;
}

// ‚îÄ‚îÄ Option selection ‚îÄ‚îÄ
function selectOpt(el) {
  if (el.closest('.q-options').dataset.locked) return;
  el.closest('.q-options').querySelectorAll('.q-opt').forEach(o => o.classList.remove('selected'));
  el.classList.add('selected');
}

// ‚îÄ‚îÄ Sort interaction: Select then Place ‚îÄ‚îÄ
let selectedSortChip = null;

function selectSortItem(el) {
  // If clicking already-selected chip, deselect it
  if (el === selectedSortChip) {
    el.classList.remove('selected');
    selectedSortChip = null;
    clearDropHighlights();
    return;
  }
  // Deselect previous
  if (selectedSortChip) selectedSortChip.classList.remove('selected');
  // Select this one
  selectedSortChip = el;
  el.classList.add('selected');
  // Highlight drop targets
  document.querySelectorAll('.sort-drop').forEach(d => {
    d.style.borderColor = 'var(--c-accent)';
    d.style.borderStyle = 'solid';
  });
}

function placeSortItem(dropEl) {
  if (!selectedSortChip) return;
  // Move chip to this category
  dropEl.appendChild(selectedSortChip);
  selectedSortChip.classList.remove('selected');
  // Allow clicking chip in category to send it back to pool
  selectedSortChip.onclick = function() { returnSortItem(this); };
  selectedSortChip = null;
  clearDropHighlights();
}

function returnSortItem(el) {
  // Send chip back to pool
  document.getElementById('sortPool').appendChild(el);
  el.onclick = function() { selectSortItem(this); };
  el.classList.remove('selected');
}

function clearDropHighlights() {
  document.querySelectorAll('.sort-drop').forEach(d => {
    d.style.borderColor = 'var(--c-border)';
    d.style.borderStyle = 'dashed';
  });
}

// ‚îÄ‚îÄ Check functions ‚îÄ‚îÄ
function checkMCQ() {
  const q = state.queue[state.current];
  const opts = document.getElementById('qOpts');
  if (opts.dataset.locked) return;
  const selected = opts.querySelector('.q-opt.selected');
  if (!selected) return;

  opts.dataset.locked = 'true';
  opts.querySelectorAll('.q-opt').forEach(o => {
    o.classList.add('locked');
    if (o.dataset.value === q.correct) o.classList.add('was-correct');
  });

  const isCorrect = selected.dataset.value === q.correct;
  if (isCorrect) {
    selected.classList.add('correct');
    state.score++;
  } else {
    selected.classList.add('wrong');
    state.wrong.push({q: q.q, explain: q.explain, topic: q.topic});
  }
  state.maxScore++;
  state.answered.push({id: q.id, topic: q.topic, correct: isCorrect});
  showFeedback(isCorrect, q.explain);
}

function checkTFQ() {
  const q = state.queue[state.current];
  const opts = document.getElementById('qOpts');
  if (opts.dataset.locked) return;
  const selected = opts.querySelector('.q-opt.selected');
  if (!selected) return;

  opts.dataset.locked = 'true';
  const userVal = selected.dataset.value === 'true';
  const isCorrect = userVal === q.correct;

  opts.querySelectorAll('.q-opt').forEach(o => {
    o.classList.add('locked');
    if ((o.dataset.value === 'true') === q.correct) o.classList.add('was-correct');
  });

  if (isCorrect) {
    selected.classList.add('correct');
    state.score++;
  } else {
    selected.classList.add('wrong');
    state.wrong.push({q: q.q, explain: q.explain, topic: q.topic});
  }
  state.maxScore++;
  state.answered.push({id: q.id, topic: q.topic, correct: isCorrect});
  showFeedback(isCorrect, q.explain);
}

function checkFillQ() {
  const q = state.queue[state.current];
  const inputs = document.querySelectorAll('.q-fill-input');
  let correct = 0;

  inputs.forEach((inp, i) => {
    const b = q.blanks[i];
    const user = inp.value.trim();
    const allAnswers = [b.answer, ...(b.alts || [])];
    if (allAnswers.some(a => a.toLowerCase() === user.toLowerCase())) {
      inp.classList.add('correct');
      correct++;
    } else if (user) {
      inp.classList.add('wrong');
      inp.title = 'L√∂sung: ' + b.answer;
    }
    inp.readOnly = true;
  });

  const total = q.blanks.length;
  const isCorrect = correct === total;
  if (isCorrect) state.score += total; 
  else state.wrong.push({q: q.q.replace(/\{(\d+)\}/g, '___'), explain: q.explain, topic: q.topic});
  state.maxScore += total;
  state.answered.push({id: q.id, topic: q.topic, correct: isCorrect});
  showFeedback(isCorrect, q.explain + (isCorrect ? '' : '<br><strong>L√∂sungen:</strong> ' + q.blanks.map(b => b.answer).join(', ')));
}

function checkCalcQ() {
  const q = state.queue[state.current];
  const inputs = document.querySelectorAll('.q-calc-input');
  let correct = 0;

  inputs.forEach((inp, i) => {
    const r = q.rows[i];
    const user = parseFloat(inp.value.replace(',', '.'));
    if (!isNaN(user) && Math.abs(user - r.answer) <= r.tolerance) {
      inp.classList.add('correct');
      correct++;
    } else {
      inp.classList.add('wrong');
      inp.title = 'L√∂sung: ' + r.answer;
    }
    inp.readOnly = true;
  });

  const total = q.rows.length;
  const isCorrect = correct === total;
  if (isCorrect) state.score += total;
  else state.wrong.push({q: q.q, explain: q.explain, topic: q.topic});
  state.maxScore += total;
  state.answered.push({id: q.id, topic: q.topic, correct: isCorrect});
  showFeedback(isCorrect, q.explain + (isCorrect ? '' : '<br><strong>L√∂sungen:</strong> ' + q.rows.map(r => r.answer + (r.unit||'')).join(', ')));
}

function checkSortQ() {
  const q = state.queue[state.current];
  const drops = document.querySelectorAll('.sort-drop');
  let correct = 0;
  let total = q.items.length;

  // Check items in each category
  drops.forEach((drop, ci) => {
    drop.querySelectorAll('.chip').forEach(chip => {
      const idx = parseInt(chip.dataset.sortIdx);
      if (q.items[idx].cat === ci) {
        chip.style.background = 'var(--c-success-bg)';
        chip.style.borderColor = 'var(--c-success)';
        chip.style.color = '#166534';
        correct++;
      } else {
        chip.style.background = 'var(--c-error-bg)';
        chip.style.borderColor = 'var(--c-error)';
        chip.style.color = '#991b1b';
      }
    });
  });

  // Check items still in pool
  document.querySelectorAll('#sortPool .chip').forEach(chip => {
    chip.style.background = 'var(--c-error-bg)';
    chip.style.borderColor = 'var(--c-error)';
    chip.style.color = '#991b1b';
  });

  const isCorrect = correct === total;
  if (isCorrect) state.score += total;
  else state.wrong.push({q: q.q, explain: q.explain, topic: q.topic});
  state.maxScore += total;
  state.answered.push({id: q.id, topic: q.topic, correct: isCorrect});
  showFeedback(isCorrect, q.explain);
}

function showFeedback(isCorrect, explain) {
  const fb = document.getElementById('qFeedback');
  fb.className = 'q-feedback visible ' + (isCorrect ? 'success' : 'error');
  fb.innerHTML = (isCorrect ? '‚úì Korrekt! ' : '‚úó ') + explain;
  document.getElementById('nextRow').style.display = 'flex';
  document.getElementById('quizScore').textContent = state.score + ' Punkt' + (state.score !== 1 ? 'e' : '');
  // Scroll feedback into view
  fb.scrollIntoView({behavior: 'smooth', block: 'nearest'});
}

function nextQuestion() {
  state.current++;
  renderQuestion();
  window.scrollTo({top: 0, behavior: 'smooth'});
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RESULTS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function endQuiz() {
  showScreen('resultsScreen');
  const pct = state.maxScore > 0 ? Math.round((state.score / state.maxScore) * 100) : 0;

  document.getElementById('resultsScore').textContent = state.score + ' / ' + state.maxScore;
  document.getElementById('resultsLabel').textContent = pct + '% richtig';

  const bar = document.getElementById('resultsBarFill');
  bar.style.width = pct + '%';
  bar.style.background = pct >= 70 ? 'var(--c-success)' : pct >= 40 ? 'var(--c-accent)' : 'var(--c-error)';

  // Topic breakdown
  const breakdown = {};
  state.answered.forEach(a => {
    if (!breakdown[a.topic]) breakdown[a.topic] = {correct: 0, total: 0};
    breakdown[a.topic].total++;
    if (a.correct) breakdown[a.topic].correct++;
  });

  let tbHtml = '';
  for (const [topic, data] of Object.entries(breakdown)) {
    const tpct = Math.round((data.correct / data.total) * 100);
    const cls = tpct >= 70 ? 'good' : tpct >= 40 ? 'ok' : 'bad';
    tbHtml += '<div class="topic-row">';
    tbHtml += '<span class="topic-name">' + TOPICS[topic].label + '</span>';
    tbHtml += '<span class="topic-score ' + cls + '">' + data.correct + '/' + data.total + ' (' + tpct + '%)</span>';
    tbHtml += '</div>';
  }
  document.getElementById('topicBreakdown').innerHTML = tbHtml;

  // Wrong answers
  if (state.wrong.length > 0) {
    document.getElementById('wrongCard').style.display = 'block';
    let wHtml = '';
    state.wrong.forEach(w => {
      wHtml += '<div class="wrong-item">';
      wHtml += '<div class="wi-q">' + TOPICS[w.topic].short + ': ' + w.q.substring(0, 120) + (w.q.length > 120 ? '‚Ä¶' : '') + '</div>';
      wHtml += '<div class="wi-a">' + w.explain + '</div>';
      wHtml += '</div>';
    });
    document.getElementById('wrongList').innerHTML = wHtml;
  } else {
    document.getElementById('wrongCard').style.display = 'none';
  }
}

function exportResults() {
  window.print();
}

function resetApp() {
  showScreen('startScreen');
  state = {
    mode: state.mode,
    filters: state.filters,
    queue: [], current: 0, score: 0, maxScore: 0, answered: [], wrong: []
  };
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HELPERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  window.scrollTo({top: 0});
}

function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

// ‚îÄ‚îÄ Initialize ‚îÄ‚îÄ
init();
</script>
</body>
</html>
